"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}var PromoDiscount=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"CheckDiscTimer",value:function(){$.ajax({url:e.cookieParams.url,method:"POST",data:{type:"show_time"},dataType:"json"}).then(function(e){if("active"==e.status){var t=e.remain;$(".digit-time-left").find("span")[0].innerText=parseInt(t/60)>=10?parseInt(t/60):"0"+parseInt(t/60).toString(),$(".digit-time-left").find("span")[1].innerText=t%60>=10?t%60:"0"+(t%60).toString(),$(".time-left").removeClass("mfp-hide");var i=setInterval(function(){(t-=1)<=0&&(clearInterval(i),$.ajax({url:"/test/ajax.php",method:"POST",data:{type:"show_time"},dataType:"json"}),$(".time-left").addClass("mfp-hide"));var e=parseInt(t/60),n=t%60;$(".digit-time-left").find("span")[0].innerText=e>=10?e:"0"+e.toString(),$(".digit-time-left").find("span")[1].innerText=n>=10?n:"0"+n.toString()},1e3)}})}},{key:"cookieParams",get:function(){return{state:"BITRIX_SM_discount_added",timestamp:"BITRIX_SM_discount_timestamp",url:"/local/templates/ladyandgentleman/action/ajax.php"}}}]),e}();$(document).ready(function(){PromoDiscount.CheckDiscTimer(),void 0!==Cookies.get("BITRIX_SM_discount_added")&&0!=Cookies.get("BITRIX_SM_discount_added")||(void 0===Cookies.get("cancel_click")||parseInt(Cookies.get("cancel_click"))<=2)&&setTimeout(function(){$.magnificPopup.open({items:{src:".promotion-popup"}})},6e4),$("a.more-detail").on("click",function(e){e.preventDefault(),$(".area3").toggleClass("mfp-hide"),$(this).find("svg").toggleClass("rotation")}),$(".area2 button").on("click",function(e){var t=this;$(this).hasClass("done")||$.ajax({url:PromoDiscount.cookieParams.url,method:"POST",data:{type:"addDiscount"},dataType:"json"}).then(function(e){"added"==e.status?($(t).addClass("done"),$(t).text("скидка применена!"),PromoDiscount.CheckDiscTimer()):"error"==e.status&&alert(e.error_text)})}),$(".promotion-popup-close").on("click",function(e){if(void 0===Cookies.get("cancel_click"))Cookies.set("cancel_click","1",{expires:365,path:"",domain:document.domain});else{var t=parseInt(Cookies.get("cancel_click"));Cookies.set("cancel_click",++t,{expires:365,path:"",domain:document.domain})}e.preventDefault(),$.magnificPopup.close()})});